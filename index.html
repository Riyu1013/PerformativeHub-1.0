<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

    <!-- Bootstrap JS -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="./styles.css">
    
    <title>Performative Website</title>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-body" id="my-nav">
  <div class="container-fluid">
    <div class="brand-wrapper">
      <a class="navbar-brand" id="hero-text" href="#">Performative <br> Website</a>
    </div>
    <div class="nav-item" id="nav-item">
      <a class="justify-content-end fs-5" href="">About</a>
    </div>
  </div>
</nav>

<div id="main-content">
  <div class="my-carousel" id="my-carousel">
    <div class="item"><a href="pages/labubu.html"> <img src="media/labubu-1.png" alt="Labubu" class="my-image"></a></div>
    <div class="item"><a href="pages/drinks.html"> <img src="media/matcha-1.png" alt="Matcha" class="my-image"></a></div>
    <div class="item"><a href="pages/music.html">  <img src="media/walkman-1.png" alt="Walkman" class="my-image"></a></div>
    <div class="item"><a href="pages/movies.html"> <img src="media/poster-1.png" alt="Movie Poster" class="my-image"></a></div>
    <div class="item"><a href="pages/books.html">  <img src="media/books/the-48-laws-of-power.png" alt="48 Laws of Power" class="my-image"></a></div>
  </div>
</div>

<canvas id="scrollingCanvas" width="1300" height="40"></canvas>

<script>
// Scroll-drag infinite carousel vibe coded using ChatGPT <3 hehe
  const slider = document.querySelector('.my-carousel');
  let isDown = false;
  let startX;
  let scrollLeft;

  // Duplicate items once on load for infinite effect
  slider.innerHTML += slider.innerHTML;
  slider.addEventListener('dragstart', (e) => e.preventDefault());
  const startDragging = (e) => {
    isDown = true;
    slider.classList.add('active');
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
  }

  const stopDragging = () => {
    isDown = false;
  }

  // Drag to scroll
  const move = (e) => {
    if(!isDown) return;
    e.preventDefault();
    const x = e.pageX - slider.offsetLeft;
    const walk = (x - startX) * 1.2; 
    slider.scrollLeft = scrollLeft - walk;

    const width = slider.scrollWidth / 2;

    // If scrolling reaches the duplicated end → jump to original
    if (slider.scrollLeft >= width) {
      slider.scrollLeft -= width;
    }
    if (slider.scrollLeft <= 0) {
      slider.scrollLeft += width;
    }
  }

  //Checks if user drags or user clicks on item
  const links = document.querySelectorAll('.my-carousel a');

  let isDragging = false;

  slider.addEventListener('mousedown', () => {
    isDragging = false; // reset on new drag
  });

  slider.addEventListener('mousemove', () => {
    isDragging = true; // user moved mouse → it’s a drag
  });

  links.forEach(link => {
    link.addEventListener('click', (e) => {
      if (isDragging) {
        e.preventDefault(); // prevent navigation if it was a drag
      }
    });
  });

  // Listeners
  slider.addEventListener('mousedown', startDragging);
  slider.addEventListener('mouseleave', stopDragging);
  slider.addEventListener('mouseup', stopDragging);
  slider.addEventListener('mousemove', move);
  // Add the event listeners
  slider.addEventListener('mousemove', move, false);
  slider.addEventListener('mousedown', startDragging, false);
  slider.addEventListener('mouseup', stopDragging, false);
  slider.addEventListener('mouseleave', stopDragging, false);





  // PROGRAM FOR THE FIRST CLICK TO UNBLUR
  const hero = document.getElementById("hero-text");
  const main = document.getElementById("main-content");
  const carousel = document.getElementById("my-carousel");
  carousel.style.pointerEvents = "none";

  // Initially blur everything except hero
  main.classList.add("blur");
  const navItem = document.getElementById("nav-item");
  navItem.classList.add("blur")

  //When clicked anywhere on the website, hero text shrinks to navbar and website unblurs
  main.addEventListener("click", () => {
    hero.classList.add("shrink");
    main.classList.remove("blur");
    navItem.classList.remove("blur");
    carousel.style.pointerEvents = "auto";
  });







  // PROGRAM FOR HOVER OVER "ITEM CARD" IN CAROUSEL

  const carouselCards = document.querySelectorAll(".my-image");
  carouselCards.forEach((img) => {
    img.addEventListener("mouseover", () => {
      img.style.filter = "blur(0px)";
    });
    img.addEventListener("mouseleave", () => {
      img.style.filter = "blur(30px)";
    });
  });






  // PROGRAM FOR CRAWLER IN FOOTER
  const canvas = document.getElementById('scrollingCanvas');
  const ctx = canvas.getContext('2d');

  // Get current display size of canvas
  const styleWidth = canvas.clientWidth;
  const styleHeight = canvas.clientHeight;

  // Increase internal resolution
  canvas.width = styleWidth * window.devicePixelRatio;
  canvas.height = styleHeight * window.devicePixelRatio;

  // Scale drawing operations to match
  ctx.scale(window.devicePixelRatio, window.devicePixelRatio);

  const text = "• CULTURAL METRIC: The optimal number of unopened copies of Sylvia Plath one must own is now three. One for the shelf, one for the tote, one for the 'just started reading.' • JUST IN: Matcha lattes officially overtake artisanal pour-overs as the superior beverage for thoughtful brooding at outdoor cafes.";
  let x = styleWidth;

  function draw() {
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, styleWidth, styleHeight);
    ctx.font = '20px OpenSauceRegular'; // large text, stays crisp
    ctx.fillStyle = 'white'
    ctx.fillText(text, x, 40);
    
    x -= 2;
    if (x < -ctx.measureText(text).width) {
      x = styleWidth;
    }
    requestAnimationFrame(draw);
  }

  draw();

</script>
</body>
</html>