<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <title>Music Page</title>
</head>
<body>

    <nav class="navbar navbar-expand-lg bg-body" id="my-nav">
        <div class="container-fluid">
            <div class="brand-wrapper">
                <a class="navbar-brand" id="hero-text.shrink" href="#">Performative <br> Website</a>
            </div>
            <div class="nav-item">
                <a class="justify-content-end fs-5" href="">About</a>
            </div>
        </div>
    </nav>

    <div class="music-body">
        <div id="song-list">
            <table class="table table-hover caption-top">
                <caption>Songs</caption>
                <thead>
                    <tr> <td> Title</td> <td> Artist</td></tr>
                </thead>
                <tbody id="song-info">
                    <tr data-album-cover="media/cairo.webp" data-audio-src="media/bags.mp3"><td>Bags</td><td>Clairo</td></tr>
                    <tr data-album-cover="media/cairo.webp" data-audio-src="media/sofia.mp3"><td>Sofia</td><td>Clairo</td></tr>
                    <tr data-album-cover="media/niki.webp" data-audio-src="media/apartment.mp3"><td>The Apartment We Won't Share</td><td>Niki</td></tr>
                    <tr data-album-cover="media/niki.webp" data-audio-src="media/youll-be-in-my-heart.mp3"><td>You'll Be In My Heart</td><td>Niki</td></tr>
                    <tr data-album-cover="media/niki.webp" data-audio-src="media/youll-be-in-my-heart.mp3"><td>You'll Be In My Heart</td><td>Niki</td></tr>
                    <tr data-album-cover="media/cairo.webp" data-audio-src="media/sofia.mp3"><td>Sofia</td><td>Clairo</td></tr>
                </tbody>
            </table>
        </div>

        <div id="vinyl-container">
            <img src="media/black-vinyl-record-with-red-label-illustration-png.png" alt="Vinyl Record" id="vinyl-record">
        </div>

        </div>

    <audio id="audio-player" style="display: none;"></audio>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script> -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const songTableBody = document.getElementById('song-info');
            const vinylContainer = document.getElementById('vinyl-container');
            const audioPlayer = document.getElementById('audio-player');
            const body = document.body; // Reference to the body 

            function displayAlbumCover(imageUrl) {
                let cover = document.getElementById('album-cover-img');

                if (!cover) {
                    // Create the element if it doesn't exist
                    cover = document.createElement('img');
                    cover.id = 'album-cover-img';
                    // The album-cover class has the necessary positioning and sizing
                    cover.classList.add('album-cover');
                    vinylContainer.appendChild(cover);
                }
                
                // Set the new image source
                cover.src = imageUrl;
            }

            songTableBody.addEventListener("click", (e) => {
                const clickedRow = e.target.closest('tr');
                
                if (clickedRow) {
                    const albumCover = clickedRow.dataset.albumCover; 
                    const audioSrc = clickedRow.dataset.audioSrc;     


                    // 2. Stop current playback and reset state
                    audioPlayer.pause();
                    audioPlayer.currentTime = 0;
                    body.classList.remove('is-playing'); // Remove spinning/visible class

                    // 3. Execution Sequence 
                    
                    // Put the album cover on top of the vinyl
                    displayAlbumCover(albumCover);
                    
                    // Start the song playing
                    audioPlayer.src = audioSrc;
                    
                    setTimeout(() => {
                        vinylContainer.classList.add('is-playing'); // This starts the CSS animation and fades in the cover
                        
                        audioPlayer.play()
                            .then(() => {
                                console.log(`Now playing: ${clickedRow.firstElementChild.textContent}`);
                            })
                            .catch(error => {
                                console.error("Audio playback failed. NOTE: HTML <audio> cannot play YouTube links. Use direct audio files (.mp3, .wav).", error);
                            });
                    }, 100); 
                }
            });
        });
</script>
</body>
</html>